# Results
```{r results-source-descriptive-analysis, child = "markdown/descriptive_analysis.Rmd"}
```
```{r results-source-significance-testing, child = "markdown/significance_testing.rmd"}
```
```{r results-source-diffusion-results, child = "markdown/diffusion_model_analysis/diffusion_model_results_report.Rmd"}
```
```{r results-source-diffusion-descriptive, child = "markdown/diffusion_model_analysis/diffusion_model_descriptive_analysis.Rmd"}
```
```{r results-source-diffusion-significance, child = "markdown/diffusion_model_analysis/diffusion_model_significance_testing.Rmd"}
```


## Behavioral Analysis
All analysis was conducted using `r r_citations$r`. `r r_citations$pkgs`
After data cleaning, `r nrow(final_data)` trials from `r demo_output$n_subjects - n_outliers` participants remained. Participants falsely responded in `r descriptive_output$mean_error_rate_nogo`% of NoGo trials resulting in a median `r average_n_location %>% filter(location == "E-1") %>% pull(median)` (SD = `r average_n_location %>% filter(location == "E-1") %>% pull(sd)`) trials prior to an error (E-1), and a median `r average_n_location %>% filter(location == "E+1") %>% pull(median)` (SD = `r average_n_location %>% filter(location == "E+1") %>% pull(sd)`) trials following an error (E+1) per participant. Descriptive statistics can be found in Table \@ref(tab:appendix-descriptive-analysis-overview-table-robust).

Highly significant main effects of RSI, `r apa_print(aov_rt_rsi_error_robust, es = "pes", mse = FALSE)$full_result$rsi` and error-condition, `r apa_print(aov_rt_rsi_error_robust, es = "pes", mse = FALSE)$full_result$error_code` on reaction time were observed. Response time were slower in the short RSI condition and slower following an error. Critically, the interaction between RSI and error-condition was highly significant, `r apa_print(aov_rt_rsi_error_robust, es = "pes", mse = FALSE)$full_result$rsi_error_code`. Post-hoc comparison reveals an increased influence of error-condition in the short RSI condition, manifesting in an increased difference in response time pre- vs. post-error.

Comparison of mean accuracy between the 2x2 conditions yielded similar patterns of significant main effects of RSI `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi` and error-condition `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$classic_pes_type` and a significant interaction effect, `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi_classic_pes_type`. Errors committed in the short RSI condition lead to a more significant decrease in accuracy on the trial immediately following the error.

<!-- Highly significant main effects of RSI, `r apa_print(aov_rt_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi` and accuracy of previous trial, `r apa_print(aov_rt_rsi_error_classic, es = "pes", mse = FALSE)$full_result$classic_pes_type` on reaction time were observed. Critically, the interaction between RSI and previous accuracy was highly significant, `r apa_print(aov_rt_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi_classic_pes_type`. Post-hoc comparison reveals an increased influence of previous accuracy in the short RSI condition, manifesting in an increase in PES. -->

<!-- Comparison of mean accuracy between the 2x2 conditions yielded similar patterns of significant main effects of RSI `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi` and previous accuracy `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$classic_pes_type` and a significant interaction effect, `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi_classic_pes_type`. Errors committed in the short RSI condition lead to a more significant decrease in accuracy on the trial immediately following the error. -->

<!-- Highly significant main effects of RSI were observed on both response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$rsi` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$rsi`, caused by responses being faster and less accurate in short RSI condition. Main effects of _NoGo-accuracy_ on response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type` were elicited by responses near correct NoGo trials being faster and more accurate. We also observed main effects of _distance_ on response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$distance` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$distance` with responses following a nogo trial being faster and less accurate. -->

<!-- Critically, we observed a significant interaction effects of _NoGo-accuracy_ and _distance_ on response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type_distance` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type_distance`. Responses around errors are faster than responses around correct NoGo trials prior to the NoGo trial and slower and less accurate following the NoGo trial. We furthermore observed a significant effect of RSI on this interaction, captured by the three-fold interaction between $RSI \times NoGo-accuracy \times distance$. **finish this** -->

### Global performance shifts
Talk about rt and accuracy shifts within trial/block
talk about post-error count shifts across blocks, this is why we chose to use the robust method

## Diffusion Model
### Model comparisons
```{r result-model-comp, cache=TRUE, cache.extra = tools::md5sum(list.files("./markdown/diffusion_model_runs/cluster/output/model_comp/waic/", pattern = ".rda", full.names = TRUE))}

library(loo)
# Reading in all models
model_path <- "./markdown/diffusion_model_runs/cluster/output/model_comp/waic/"
base_model <- rio::import(paste0(model_path, "base_model_robust.rda"))
no_rsi_model <- rio::import(paste0(model_path, "no_rsi.rda"))
no_error_factor_model <- rio::import(paste0(model_path, "no_error_factor.rda"))

no_err_drift_model <- rio::import(paste0(model_path, "no_err_drift.rda"))
no_err_bs_model <- rio::import(paste0(model_path, "no_err_bs.rda"))
no_err_bias_model <- rio::import(paste0(model_path, "no_err_bias.rda"))
no_err_ndt_model <- rio::import(paste0(model_path, "no_err_ndt.rda"))

no_rsi_drift_model <- rio::import(paste0(model_path, "no_rsi_drift.rda"))
no_rsi_bs_model <- rio::import(paste0(model_path, "no_rsi_bs.rda"))
no_rsi_bias_model <- rio::import(paste0(model_path, "no_rsi_bias.rda"))
no_rsi_ndt_model <- rio::import(paste0(model_path, "no_rsi_ndt.rda"))

only_drift_model <- rio::import(paste0(model_path, "only_drift.rda"))
only_bias_model <- rio::import(paste0(model_path, "only_bias.rda"))
only_ndt_model <- rio::import(paste0(model_path, "only_ndt.rda"))
only_bs_model <- rio::import(paste0(model_path, "only_bs.rda"))

optimized_model <- rio::import(paste0(model_path, "optimized_model.rda"))

baseline_comp <- loo_compare(base_model, no_rsi_model, no_error_factor_model)

rsi_comp <- loo_compare(no_rsi_model, no_rsi_bias_model, no_rsi_drift_model, no_rsi_ndt_model, no_rsi_bs_model, base_model)

err_comp <- loo_compare(base_model, no_err_bias_model, no_err_drift_model, no_err_bs_model, no_err_ndt_model, no_error_factor_model)

only_comp <- loo_compare(no_error_factor_model, base_model, 
            only_drift_model, only_bs_model, only_ndt_model, only_bias_model)

optimized_comp <- loo_compare(base_model, optimized_model, no_rsi_bs_model, no_rsi_bias_model, no_rsi_model)
```

The base model was superior to all other models tested. Thus we retained the influence of both factors on all parameters for analysis in the full location model. When restricting the influence of RSI on only one of the parameters, restricting its influence on the drift rate had the most detrimental effects. Constraining the bias and boundary separation to be equal across RSI conditions barely worsened predictive accuracy (see Table \@ref(tab:appendix-rsi-compare)). A similar pattern was found when restricting the impact of error-condition on only one of the parameters while allowing all other parameters to vary between pre- and post-error. Here, restricting the drift rate parameter specification again had the biggest negative impact on predictive accuracy (see Table \@ref(tab:appendix-err-compare)). When only allowing one of the four diffusion model parameter to vary between error-condition, drift rate again proved to be the single most important parameter for good predictive accuracy (see Table \@ref(tab:appendix-only-compare)).

### Model Fit
The best-fitting model specification was used to estimate parameters in the full location dataset and was then subjected to various model diagnostic tests. There were no divergent transitions, $\hat{R} > 1.01$ or other signs of non-convergence [@gelman1992]. We visually inspected if the 4 chains mixed well for a few randomly selected parameters, observing no signs of misbehavior in the chains. **correlations among posterior parameters**

We sampled the posterior parameter distribution 500 times and obtained predicted response time distributions from the sampled parameters. We then compared empirical response time distributions to the predicted response time distribution for each condition. This revealed a serious discrepancy between the predicted response time distribution and the empirical distribution in post-error trials in the short RSI condition(see Figure  \@ref(fig:results-plot-ep1-bad-pred)). The exact impact and cause of this discrepancy will be discussed later, but we will refrain from interpreting the results in the short RSI condition.

```{r results-plot-ep1-bad-pred, warning = FALSE, fig.cap='Comparison of empirical and predicted response time distribution in short RSI condition for post-error trials'}
ep1 %>% 
  ggplot(
    aes(
      x = rt,
      fill = type,
      group = type
    )
  )+
  geom_density(alpha = 0.5)+
  labs(
    x = "Response time (in s)",
    y = "density",
    color = "Type"
  )+
  theme_classic()+
  xlim(0, 1)+
  theme(text = element_text(size = 15))
```

### Modeling Results
Final analysis of the full location model was based on a total of `r nrow(diffusion_data_location)` Go trials with a median `r location_median_count$median` (SD = `r location_median_count$sd`) trials per RSI $\times$ error-condition combination^[The exact number of trials per condition can be found in Table \@ref(tab:appendix-table-location-counts).]. The model estimated a total of 132 parameters. 

We will restrict interpretation and reporting of results to model parameters in the long RSI condition due to the models inability to fit data of post-error trials in the short RSI condition. Parameters obtained from fitting the DDM to the short RSI condition can be found in Appendix D.

<!-- In the short RSI condition we observed a significant **testing** decrease in drift rate in post-error trials compared to pre-error levels. Boundary separation also decreased significantly **testing** and responses were less biased away from the previously presented stimulus following an error. Non-decision time was increased following an error response **testing**. Following an error, participants were less biased towards the previously not shown response than they were prior to the error **testing**. The course of parameter changes following an error or following a correct response is illustrated in **FIGURE** **maybe split that short/long?** -->
We observed a significant decrease in drift rate in post-error trials compared to pre-error levels in the long RSI conditions **testing**. Boundary separation decreased and responses were less biased towards the previously not shown response. We found no evidence in favor of increasing non-decision time following an error. **TEST THOSE, Bayes Factor** Graphical illustrations of parameter development following errors and correct NoGo responses can be found in Appendix D.

**talk about pre-error vs. pre-correct here!**
**Testing!**
We also compared trials prior to errors (E-1) to those preceding correct responses (C-1) to investigate _pre-error speeding_. The model was able to provide reasonable fit to the data in both RSI conditions here, allowing us to study pre-error speeding in both the short and long RSI condition.

Behaviorally we observed smaller response times prior to errors in both conditions, with the effect being more pronounced in the long RSI condition.

In the long RSI condition we observed lower drift rates and lower boundary separation in pre-error trials with the decrease in boundary separation being responsible for faster response times.

Parameter differences were more complex in the short RSI condition. Lower drift rates, increased non-decision time and less biased response pre-error compared to pre-correct predict slower response times. These differences are however overpowered by a significantly lower boundary separation pre-error, resulting in net faster response times pre-error compared to pre correct. 

Differences in bias and non-decision time were only present in the short RSI condition. The differences in drift rate and boundary separation were also more pronounced in the short RSI condition.



