# Results
```{r results-source-descriptive-analysis, child = "markdown/descriptive_analysis.Rmd"}
```

```{r results-source-significance-testing, child = "markdown/significance_testing.rmd"}
```

```{r results-importing-diffusion-data}
diffusion_data_location <- rio::import("./markdown/data/diffusion_data_location.Rdata")
diffusion_data_robust <- rio::import("./markdown/data/diffusion_data_robust.Rdata")
diffusion_data_classic <- rio::import("./markdown/data/diffusion_data_classic.Rdata")
```

## Behavioral Analysis
All analysis was conducted using `r r_citations$r`. `r r_citations$pkgs`
After data cleaning, `r nrow(final_data)` trials from `r demo_output$n_subjects - n_outliers` participants remained. Participants falsely responded in `r descriptive_output$mean_error_rate_nogo`% of NoGo trials resulting in a median `r average_n_location %>% filter(location == "E-1") %>% pull(median)` (SD = `r average_n_location %>% filter(location == "E-1") %>% pull(sd)`) trials prior to an error (E-1), and a median `r average_n_location %>% filter(location == "E+1") %>% pull(median)` (SD = `r average_n_location %>% filter(location == "E+1") %>% pull(sd)`) trials following an error (E+1) per participant. Descriptive statistics can be found in Table \@ref(tab:appendix-descriptive-analysis-overview-table-robust).

Highly significant main effects of RSI, `r apa_print(aov_rt_rsi_error_robust, es = "pes", mse = FALSE)$full_result$rsi` and error-condition, `r apa_print(aov_rt_rsi_error_robust, es = "pes", mse = FALSE)$full_result$error_code` on reaction time were observed. Response time were slower in the short RSI condition and slower following an error. Critically, the interaction between RSI and error-condition was highly significant, `r apa_print(aov_rt_rsi_error_robust, es = "pes", mse = FALSE)$full_result$rsi_error_code`. Post-hoc comparison reveals an increased influence of error-condition in the short RSI condition, manifesting in an increased difference in response time pre- vs. post-error.

Comparison of mean accuracy between the 2x2 conditions yielded similar patterns of significant main effects of RSI `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi` and error-condition `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$classic_pes_type` and a significant interaction effect, `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi_classic_pes_type`. Errors committed in the short RSI condition lead to a more significant decrease in accuracy on the trial immediately following the error.

<!-- Highly significant main effects of RSI, `r apa_print(aov_rt_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi` and accuracy of previous trial, `r apa_print(aov_rt_rsi_error_classic, es = "pes", mse = FALSE)$full_result$classic_pes_type` on reaction time were observed. Critically, the interaction between RSI and previous accuracy was highly significant, `r apa_print(aov_rt_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi_classic_pes_type`. Post-hoc comparison reveals an increased influence of previous accuracy in the short RSI condition, manifesting in an increase in PES. -->

<!-- Comparison of mean accuracy between the 2x2 conditions yielded similar patterns of significant main effects of RSI `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi` and previous accuracy `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$classic_pes_type` and a significant interaction effect, `r apa_print(aov_acc_rsi_error_classic, es = "pes", mse = FALSE)$full_result$rsi_classic_pes_type`. Errors committed in the short RSI condition lead to a more significant decrease in accuracy on the trial immediately following the error. -->

<!-- Highly significant main effects of RSI were observed on both response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$rsi` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$rsi`, caused by responses being faster and less accurate in short RSI condition. Main effects of _NoGo-accuracy_ on response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type` were elicited by responses near correct NoGo trials being faster and more accurate. We also observed main effects of _distance_ on response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$distance` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$distance` with responses following a nogo trial being faster and less accurate. -->

<!-- Critically, we observed a significant interaction effects of _NoGo-accuracy_ and _distance_ on response time `r apa_print(aov_rt_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type_distance` and accuracy `r apa_print(aov_acc_rsi_error_location, es = "pes", mse = FALSE)$full_result$nogo_type_distance`. Responses around errors are faster than responses around correct NoGo trials prior to the NoGo trial and slower and less accurate following the NoGo trial. We furthermore observed a significant effect of RSI on this interaction, captured by the three-fold interaction between $RSI \times NoGo-accuracy \times distance$. **finish this** -->

```{r results-anova-rsi-rt, results = 'asis', eval = FALSE}
# Maybe move these to appendix
apa_print(aov_rt_rsi_error_classic)$table %>% 
  mutate(
    term = c("RSI", "previous accuracy", "RSI $\\times$ previous accuracy")
  ) %>% 
  rename(
    "Effect" = term
  ) %>% 
  apa_table(
    caption = "Effects of RSI and previous accuracy on mean reaction times",
    note = "Both factors were manipulated within participants, with RSI being either 200ms or 1000ms. Previous accuracy refers to the accuracy of the response in the previous NoGo trial")
```

```{r results-anova-rsi-acc, results = 'asis', eval = FALSE}
apa_print(aov_acc_rsi_error_classic)$table %>% 
  mutate(
    term = c("RSI", "previous accuracy", "RSI $\\times$ previous accuracy")
  ) %>% 
  rename(
    "Effect" = term
  ) %>% 
  apa_table(
    caption = "Effects of RSI and previous accuracy on mean accuracy",
    note = "Both factors were manipulated within participants, with RSI being either 200ms or 1000ms. Previous accuracy refers to the accuracy of the response in the previous NoGo trial")
```

## Diffusion Model
### Model comparisons
**Provide loo and stuff here.**

### Model Fit
The best-fitting model specification was used to estimate parameters in the full location dataset and was then subjected to various model diagnostic tests. There were no divergent transitions, $\hat{R} > 1.01$ or other signs of non-convergence [@gelman1992]. We visually inspected if the 4 chains mixed well for a few randomly selected parameters, observing no signs of misbehavior in the chains. **correlations among posterior parameters**

We sampled the posterior parameter distribution 500 times and obtained predicted response time distributions from the sampled parameters. We then compared empirical response time distributions to the predicted response time distribution for each condition. This revealed a serious discrepancy between the predicted response time distribution and the empirical distribution in post-error trials in the short RSI condition(**see figure**). The exact impact and cause of this discrepancy will be discussed later, but we will proceed with extreme caution when interpreting the results.

### Modeling Results
Final analysis of the full location model was based on a total of `r nrow(diffusion_data_location)` Go trials.^[The exact number of trials per condition can be found in table \@ref(tab:appendix-table-location-counts).] The model estimated a total of 132 parameters. 

In the short RSI condition we observed a significant **testing** decrease in drift rate in post-error trials compared to pre-error levels. Boundary separation also decreased significantly **testing** and responses were less biased away from the previously presented stimulus following an error. Non-decision time was increased following an error response **testing**.

In the long RSI condition we also observed a significant decrease in drift rate in post-errro

Interaction effects of RSIxError cond were observed in:

Trials that go into the modelling, describe the number of parameters and the minimum number of trials in one condition.

Describe post-error effects by condition
in the short condition: plot drift rate and bs 
in the long condition:

Interaction effects of ...

