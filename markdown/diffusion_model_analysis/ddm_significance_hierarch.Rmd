---
editor_options:
  chunk_output_type: console
---
```{r ddm-significance-setup}
# Library calls
library(brms)
library(tidyverse)
library(tidybayes)
library(emmeans)
library(loo)
library(BayesFactor)
# library(effectsize)
library(effsize)
```

```{r ddm-significance-functions}
# Custom functions

```

```{r ddm-significance-data, cache = TRUE}
# Reading in data 
fit_robust <- rio::import("./markdown/diffusion_model_runs/cluster/output/hierarch_model_long_robust.rda")

posterior_robust <- as_draws_df(
  fit_robust
)

posterior_location <- as_draws_df(
  fit
)
```

```{r testing-robust-drift, cache = TRUE}
# Testing drift
posterior_robust_drift <- posterior_robust %>% 
  select(starts_with("b_error"))

colnames(posterior_robust_drift) <- c("post_error", "pre_error")

t_test_robust_drift <- t.test(posterior_robust_drift$pre_error, posterior_robust_drift$post_error)

cohens_d_robust_drift <- cohen.d(posterior_robust_drift$pre_error, posterior_robust_drift$post_error)
```

```{r testing-robust-bs, cache = TRUE}
# Testing drift
posterior_robust_bs <- posterior_robust %>% 
  select(starts_with("b_bs_error"))

colnames(posterior_robust_bs) <- c("post_error", "pre_error")

# bf_robust_bs <- ttestBF(posterior_robust_bs$pre_error, posterior_robust_bs$post_error)@bayesFactor$bf

t_test_robust_bs <- t.test(posterior_robust_bs$pre_error, posterior_robust_bs$post_error)

cohens_d_robust_bs <- cohen.d(posterior_robust_bs$pre_error, posterior_robust_bs$post_error)
```

```{r testing-robust-ndt, cache = TRUE}
posterior_robust_ndt <- posterior_robust %>% 
  select(starts_with("b_ndt_error"))

colnames(posterior_robust_ndt) <- c("post_error", "pre_error")

# bf_robust_ndt <- ttestBF(posterior_robust_ndt$pre_error, posterior_robust_ndt$post_error)@bayesFactor$bf

t_test_robust_ndt <- t.test(posterior_robust_ndt$pre_error, posterior_robust_ndt$post_error)

cohens_d_robust_ndt <- cohen.d(posterior_robust_ndt$pre_error, posterior_robust_ndt$post_error)
```

```{r testing-robust-bias, cache = TRUE}
# Testing drift
posterior_robust_bias <- posterior_robust %>% 
  select(starts_with("b_bias_error"))

colnames(posterior_robust_bias) <- c("post_error",
                                     "pre_error")
# bf_robust_bias_X <- ttestBF(posterior_robust_bias$pre_error_X, posterior_robust_bias$post_error_X)@bayesFactor$bf

# bf_robust_bias_Y <- ttestBF(posterior_robust_bias$pre_error_Y, posterior_robust_bias$post_error_Y)@bayesFactor$bf

t_test_robust_bias <- t.test(posterior_robust_bias$pre_error, posterior_robust_bias$post_error)

cohens_d_robust_bias <- cohen.d(posterior_robust_bias$pre_error, posterior_robust_bias$post_error)

```